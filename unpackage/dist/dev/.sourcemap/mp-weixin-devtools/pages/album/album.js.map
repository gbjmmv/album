{"version":3,"names":["albumStore","stores_album","useAlbumStore","albumList","common_vendor","ref","options","reactive","text","style","backgroundColor","showCreateDialog","albumName","openCreateDialog","value","closeCreateDialog","showEditDialog","editAlbumName","currentEditId","getAlbum","_ref","_asyncToGenerator2","_regeneratorRuntime2","mark","_callee","i","wrap","_callee$","_context","prev","next","getAlbumList","sent","length","coverPhotoUrl","utils_url","getAvatarUrl","stop","apply","arguments","onLoad","_callee2","_callee2$","_context2","confirmCreate","_ref3","_callee3","_callee3$","_context3","trim","createNewAlbum","index","__f__","showToast","title","icon","confirmEdit","_ref4","_callee4","_callee4$","_context4","updateAlbum","closeEditDialog","handleClick","album","navigateTo","url","concat","id","encodeURIComponent","name","handleSwipeClick","e","item","handleEdit","handleDelete","showModal","content","success","_success","_callee5","res","_callee5$","_context5","confirm","deleteAlbum","_x","wx","createPage","_sfc_main"],"sources":["album.vue","cGFnZXMvYWxidW0vYWxidW0udnVl"],"sourcesContent":["<script setup>\nimport {ref, reactive} from 'vue'\nimport {onLoad, onShow} from '@dcloudio/uni-app'\nimport {useAlbumStore} from '@/stores/album.js'\nimport {getAvatarUrl} from '@/utils/url.js'\n\nconst albumStore = useAlbumStore()\nconst albumList = ref([])\nconst options = reactive([\n  {\n    text: '编辑',\n    style: {\n      backgroundColor: '#007aff'\n    }\n  },\n  {\n    text: '删除',\n    style: {\n      backgroundColor: '#dd524d'\n    }\n  }\n]);\n\n// 创建相册相关\nconst showCreateDialog = ref(false);\nconst albumName = ref('');\n\nconst openCreateDialog = () => {\n  showCreateDialog.value = true;\n  albumName.value = '';  // 重置输入框\n};\n\nconst closeCreateDialog = () => {\n  showCreateDialog.value = false;\n};\n\n// 编辑相册相关\nconst showEditDialog = ref(false);\nconst editAlbumName = ref('');\nconst currentEditId = ref(null);\n\nconst getAlbum = async () => {\n  albumList.value = await albumStore.getAlbumList()\n  for(let i=0; i<albumList.value.length; i++) {\n    if(albumList.value[i].coverPhotoUrl){\n      albumList.value[i].coverPhotoUrl = getAvatarUrl(albumList.value[i].coverPhotoUrl)\n    } else {\n      albumList.value[i].coverPhotoUrl = \"/static/image/classify.png\"\n    }\n  }\n}\n\nonLoad(async ()=>{\n  await getAlbum()\n})\n\nconst confirmCreate = async() => {\n  if (albumName.value.trim()) {\n    await albumStore.createNewAlbum(albumName.value)\n    console.log('创建新相册:', albumName.value);\n\n    // 关闭弹窗\n    closeCreateDialog();\n    // 重新获取相册列表\n    await getAlbum();\n  } else {\n    // 提示用户输入相册名称\n    uni.showToast({\n      title: '请输入相册名称',\n      icon: 'none'\n    });\n  }\n};\n\nconst confirmEdit = async() => {\n  if (editAlbumName.value.trim()) {\n    // 只传递id和name两个参数给后端方法\n    await albumStore.updateAlbum(currentEditId.value, editAlbumName.value)\n    console.log('更新相册 - ID:', currentEditId.value, '新名称:', editAlbumName.value);\n\n    // 关闭弹窗\n    closeEditDialog();\n    // 重新获取相册列表\n    await getAlbum();\n  } else {\n    // 提示用户输入相册名称\n    uni.showToast({\n      title: '请输入相册名称',\n      icon: 'none'\n    });\n  }\n};\n\nconst closeEditDialog = () => {\n  showEditDialog.value = false;\n  currentEditId.value = null;\n};\n\nconst handleClick = (album) => {\n  console.log('点击相册:', album);\n  uni.navigateTo({\n    url: `/pages/AlbumPage/AlbumPage?id=${album.id}&name=${encodeURIComponent(album.name)}`\n  });\n}\n\nconst handleSwipeClick = (e, item, index) => {\n  // e.index 是点击的按钮索引，0是第一个按钮(编辑)，1是第二个按钮(删除)\n  if (e.index === 0) {\n    handleEdit(item.id, item.name);\n  } else if (e.index === 1) {\n    handleDelete(item, index);\n  }\n};\n\nconst handleEdit = (id, name) => {\n  console.log('编辑相册：id=' + id + ', name=' + name);\n  // 设置当前编辑的相册ID和名称\n  currentEditId.value = id;\n  editAlbumName.value = name;\n  // 显示编辑弹窗\n  showEditDialog.value = true;\n};\n\n// 删除方法\nconst handleDelete = (item) => {\n  console.log('删除相册：', item);\n  // 实现你的删除逻辑\n  uni.showModal({\n    title: '提示',\n    content: '确定要删除该相册吗？',\n    success: async (res) => {\n      if (res.confirm) {\n        // 确认删除\n        await albumStore.deleteAlbum(item.id);\n        // 重新获取相册列表\n        await getAlbum();\n      }\n    }\n  });\n};\n</script>\n\n<template>\n  <view class=\"album-container\">\n    <!-- 相册列表 -->\n    <view class=\"album-list\">\n      <view class=\"album-item-wrapper\" v-for=\"(subAlbum, index) in albumList\" :key=\"subAlbum.id\">\n        <uni-swipe-action>\n          <uni-swipe-action-item :right-options=\"options\" @click=\"handleSwipeClick($event, subAlbum, index)\">\n            <view class=\"album-item\" @click=\"handleClick(subAlbum)\">\n              <view class=\"album-info\">\n                <view class=\"album-name\">{{ subAlbum.name }}</view>\n                <view class=\"album-count\">{{ subAlbum.number }}张</view>\n              </view>\n              <view class=\"album-cover\">\n                <image :src=\"subAlbum.coverPhotoUrl\" mode=\"aspectFill\"></image>\n              </view>\n            </view>\n          </uni-swipe-action-item>\n        </uni-swipe-action>\n      </view>\n    </view>\n\n    <!-- 新建相册按钮 -->\n    <view class=\"create-album\">\n      <view class=\"create-text\">新建相册</view>\n      <uni-icons @click=\"openCreateDialog\" class=\"create-icon\" color=\"#28b389\" type=\"plus\" size=\"60\"></uni-icons>\n    </view>\n\n    <!-- 创建相册弹窗 -->\n    <view class=\"dialog-overlay\" v-if=\"showCreateDialog\" @click.stop=\"closeCreateDialog\">\n      <view class=\"dialog-content\" @click.stop>\n        <view class=\"dialog-header\">\n          <text class=\"dialog-title\">创建新相册</text>\n        </view>\n\n        <view class=\"dialog-body\">\n          <input\n              class=\"album-input\"\n              type=\"text\"\n              v-model=\"albumName\"\n              placeholder=\"请输入相册名称\"\n              maxlength=\"20\"\n          />\n        </view>\n\n        <view class=\"dialog-footer\">\n          <button class=\"btn btn-cancel\" @click=\"closeCreateDialog\">取消</button>\n          <button class=\"btn btn-confirm\" @click=\"confirmCreate\">确定</button>\n        </view>\n      </view>\n    </view>\n\n    <!-- 编辑相册弹窗 -->\n    <view class=\"dialog-overlay\" v-if=\"showEditDialog\" @click.stop=\"closeEditDialog\">\n      <view class=\"dialog-content\" @click.stop>\n        <view class=\"dialog-header\">\n          <text class=\"dialog-title\">编辑相册</text>\n        </view>\n\n        <view class=\"dialog-body\">\n          <input\n              class=\"album-input\"\n              type=\"text\"\n              v-model=\"editAlbumName\"\n              placeholder=\"请输入新的相册名称\"\n              maxlength=\"20\"\n          />\n        </view>\n\n        <view class=\"dialog-footer\">\n          <button class=\"btn btn-cancel\" @click=\"closeEditDialog\">取消</button>\n          <button class=\"btn btn-confirm\" @click=\"confirmEdit\">确定</button>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n\n<style>\n/* 页面整体容器 */\n.album-container {\n  padding: 20rpx;\n  height: 100%;\n  box-sizing: border-box;\n}\n\n/* 相册列表样式 */\n.album-list {\n  width: 100%;\n}\n\n.album-item-wrapper {\n  margin-bottom: 20rpx;\n  width: 100%;\n}\n\n/* 相册条目样式 */\n.album-item {\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  background-color: #ffffff;\n  padding: 20rpx 30rpx;\n  border-radius: 12rpx;\n  height: 140rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\n}\n\n/* 相册信息区域（名称和数量） */\n.album-info {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  margin-right: 20rpx;\n  flex: 1;\n}\n\n.album-name {\n  font-size: 34rpx;\n  color: #333333;\n  font-weight: 500;\n  margin-bottom: 8rpx;\n  text-align: left;\n}\n\n.album-count {\n  font-size: 26rpx;\n  color: #999999;\n  text-align: left;\n}\n\n/* 相册封面 */\n.album-cover {\n  width: 120rpx;\n  height: 120rpx;\n  border-radius: 8rpx;\n  overflow: hidden;\n}\n\n.album-cover image {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n/* 新建相册按钮区域 */\n.create-album {\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  margin-top: 40rpx;\n  padding-right: 20rpx;\n}\n\n.create-text {\n  font-size: 32rpx;\n  color: #333333;\n  margin-right: 20rpx;\n}\n\n.create-icon {\n  line-height: 1;\n}\n\n/* 弹窗样式 */\n.dialog-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 999;\n}\n\n.dialog-content {\n  width: 80%;\n  max-width: 600rpx;\n  background-color: #ffffff;\n  border-radius: 16rpx;\n  overflow: hidden;\n  box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.1);\n}\n\n.dialog-header {\n  padding: 30rpx;\n  text-align: center;\n  border-bottom: 1rpx solid #f0f0f0;\n}\n\n.dialog-title {\n  font-size: 32rpx;\n  font-weight: 500;\n  color: #333333;\n}\n\n.dialog-body {\n  padding: 30rpx;\n}\n\n.album-input {\n  width: 100%;\n  height: 80rpx;\n  background-color: #f5f5f5;\n  border-radius: 8rpx;\n  padding: 0 20rpx;\n  font-size: 28rpx;\n  box-sizing: border-box;\n}\n\n.dialog-footer {\n  display: flex;\n  border-top: 1rpx solid #f0f0f0;\n}\n\n.btn {\n  flex: 1;\n  height: 90rpx;\n  line-height: 90rpx;\n  text-align: center;\n  font-size: 30rpx;\n  border: none;\n  background-color: transparent;\n}\n\n.btn-cancel {\n  color: #666666;\n  border-right: 1rpx solid #f0f0f0;\n}\n\n.btn-confirm {\n  color: #28b389;\n  font-weight: 500;\n}\n</style>","import MiniProgramPage from 'C:/Users/ADMIN/Documents/HBuilderProjects/宝宝照片/pages/album/album.vue'\nwx.createPage(MiniProgramPage)"],"mappings":"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","ignoreList":[]}