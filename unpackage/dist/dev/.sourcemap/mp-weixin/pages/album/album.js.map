{"version":3,"file":"album.js","sources":["pages/album/album.vue","../../HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYWxidW0vYWxidW0udnVl"],"sourcesContent":["<script setup>\nimport {ref, reactive} from 'vue'\nimport {onLoad, onShow} from '@dcloudio/uni-app'\nimport {useAlbumStore} from '@/stores/album.js'\nimport {getAvatarUrl} from '@/utils/url.js'\n\nconst albumStore = useAlbumStore()\nconst albumList = ref([])\nconst options = reactive([\n  {\n    text: '编辑',\n    style: {\n      backgroundColor: '#007aff'\n    }\n  },\n  {\n    text: '删除',\n    style: {\n      backgroundColor: '#dd524d'\n    }\n  }\n]);\n\n// 创建相册相关\nconst showCreateDialog = ref(false);\nconst albumName = ref('');\n\nconst openCreateDialog = () => {\n  showCreateDialog.value = true;\n  albumName.value = '';  // 重置输入框\n};\n\nconst closeCreateDialog = () => {\n  showCreateDialog.value = false;\n};\n\n// 编辑相册相关\nconst showEditDialog = ref(false);\nconst editAlbumName = ref('');\nconst currentEditId = ref(null);\n\nconst getAlbum = async () => {\n  albumList.value = await albumStore.getAlbumList()\n  for(let i=0; i<albumList.value.length; i++) {\n    if(albumList.value[i].coverPhotoUrl){\n      albumList.value[i].coverPhotoUrl = getAvatarUrl(albumList.value[i].coverPhotoUrl)\n    } else {\n      albumList.value[i].coverPhotoUrl = \"/static/image/classify.png\"\n    }\n  }\n}\n\nonLoad(async ()=>{\n  await getAlbum()\n})\n\nconst confirmCreate = async() => {\n  if (albumName.value.trim()) {\n    await albumStore.createNewAlbum(albumName.value)\n    console.log('创建新相册:', albumName.value);\n\n    // 关闭弹窗\n    closeCreateDialog();\n    // 重新获取相册列表\n    await getAlbum();\n  } else {\n    // 提示用户输入相册名称\n    uni.showToast({\n      title: '请输入相册名称',\n      icon: 'none'\n    });\n  }\n};\n\nconst confirmEdit = async() => {\n  if (editAlbumName.value.trim()) {\n    // 只传递id和name两个参数给后端方法\n    await albumStore.updateAlbum(currentEditId.value, editAlbumName.value)\n    console.log('更新相册 - ID:', currentEditId.value, '新名称:', editAlbumName.value);\n\n    // 关闭弹窗\n    closeEditDialog();\n    // 重新获取相册列表\n    await getAlbum();\n  } else {\n    // 提示用户输入相册名称\n    uni.showToast({\n      title: '请输入相册名称',\n      icon: 'none'\n    });\n  }\n};\n\nconst closeEditDialog = () => {\n  showEditDialog.value = false;\n  currentEditId.value = null;\n};\n\nconst handleClick = (album) => {\n  console.log('点击相册:', album);\n  uni.navigateTo({\n    url: `/pages/AlbumPage/AlbumPage?id=${album.id}&name=${encodeURIComponent(album.name)}`\n  });\n}\n\nconst handleSwipeClick = (e, item, index) => {\n  // e.index 是点击的按钮索引，0是第一个按钮(编辑)，1是第二个按钮(删除)\n  if (e.index === 0) {\n    handleEdit(item.id, item.name);\n  } else if (e.index === 1) {\n    handleDelete(item, index);\n  }\n};\n\nconst handleEdit = (id, name) => {\n  console.log('编辑相册：id=' + id + ', name=' + name);\n  // 设置当前编辑的相册ID和名称\n  currentEditId.value = id;\n  editAlbumName.value = name;\n  // 显示编辑弹窗\n  showEditDialog.value = true;\n};\n\n// 删除方法\nconst handleDelete = (item) => {\n  console.log('删除相册：', item);\n  // 实现你的删除逻辑\n  uni.showModal({\n    title: '提示',\n    content: '确定要删除该相册吗？',\n    success: async (res) => {\n      if (res.confirm) {\n        // 确认删除\n        await albumStore.deleteAlbum(item.id);\n        // 重新获取相册列表\n        await getAlbum();\n      }\n    }\n  });\n};\n</script>\n\n<template>\n  <view class=\"album-container\">\n    <!-- 相册列表 -->\n    <view class=\"album-list\">\n      <view class=\"album-item-wrapper\" v-for=\"(subAlbum, index) in albumList\" :key=\"subAlbum.id\">\n        <uni-swipe-action>\n          <uni-swipe-action-item :right-options=\"options\" @click=\"handleSwipeClick($event, subAlbum, index)\">\n            <view class=\"album-item\" @click=\"handleClick(subAlbum)\">\n              <view class=\"album-info\">\n                <view class=\"album-name\">{{ subAlbum.name }}</view>\n                <view class=\"album-count\">{{ subAlbum.number }}张</view>\n              </view>\n              <view class=\"album-cover\">\n                <image :src=\"subAlbum.coverPhotoUrl\" mode=\"aspectFill\"></image>\n              </view>\n            </view>\n          </uni-swipe-action-item>\n        </uni-swipe-action>\n      </view>\n    </view>\n\n    <!-- 新建相册按钮 -->\n    <view class=\"create-album\">\n      <view class=\"create-text\">新建相册</view>\n      <uni-icons @click=\"openCreateDialog\" class=\"create-icon\" color=\"#28b389\" type=\"plus\" size=\"60\"></uni-icons>\n    </view>\n\n    <!-- 创建相册弹窗 -->\n    <view class=\"dialog-overlay\" v-if=\"showCreateDialog\" @click.stop=\"closeCreateDialog\">\n      <view class=\"dialog-content\" @click.stop>\n        <view class=\"dialog-header\">\n          <text class=\"dialog-title\">创建新相册</text>\n        </view>\n\n        <view class=\"dialog-body\">\n          <input\n              class=\"album-input\"\n              type=\"text\"\n              v-model=\"albumName\"\n              placeholder=\"请输入相册名称\"\n              maxlength=\"20\"\n          />\n        </view>\n\n        <view class=\"dialog-footer\">\n          <button class=\"btn btn-cancel\" @click=\"closeCreateDialog\">取消</button>\n          <button class=\"btn btn-confirm\" @click=\"confirmCreate\">确定</button>\n        </view>\n      </view>\n    </view>\n\n    <!-- 编辑相册弹窗 -->\n    <view class=\"dialog-overlay\" v-if=\"showEditDialog\" @click.stop=\"closeEditDialog\">\n      <view class=\"dialog-content\" @click.stop>\n        <view class=\"dialog-header\">\n          <text class=\"dialog-title\">编辑相册</text>\n        </view>\n\n        <view class=\"dialog-body\">\n          <input\n              class=\"album-input\"\n              type=\"text\"\n              v-model=\"editAlbumName\"\n              placeholder=\"请输入新的相册名称\"\n              maxlength=\"20\"\n          />\n        </view>\n\n        <view class=\"dialog-footer\">\n          <button class=\"btn btn-cancel\" @click=\"closeEditDialog\">取消</button>\n          <button class=\"btn btn-confirm\" @click=\"confirmEdit\">确定</button>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n\n<style>\n/* 页面整体容器 */\n.album-container {\n  padding: 20rpx;\n  height: 100%;\n  box-sizing: border-box;\n}\n\n/* 相册列表样式 */\n.album-list {\n  width: 100%;\n}\n\n.album-item-wrapper {\n  margin-bottom: 20rpx;\n  width: 100%;\n}\n\n/* 相册条目样式 */\n.album-item {\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  background-color: #ffffff;\n  padding: 20rpx 30rpx;\n  border-radius: 12rpx;\n  height: 140rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\n}\n\n/* 相册信息区域（名称和数量） */\n.album-info {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  margin-right: 20rpx;\n  flex: 1;\n}\n\n.album-name {\n  font-size: 34rpx;\n  color: #333333;\n  font-weight: 500;\n  margin-bottom: 8rpx;\n  text-align: left;\n}\n\n.album-count {\n  font-size: 26rpx;\n  color: #999999;\n  text-align: left;\n}\n\n/* 相册封面 */\n.album-cover {\n  width: 120rpx;\n  height: 120rpx;\n  border-radius: 8rpx;\n  overflow: hidden;\n}\n\n.album-cover image {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n/* 新建相册按钮区域 */\n.create-album {\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  margin-top: 40rpx;\n  padding-right: 20rpx;\n}\n\n.create-text {\n  font-size: 32rpx;\n  color: #333333;\n  margin-right: 20rpx;\n}\n\n.create-icon {\n  line-height: 1;\n}\n\n/* 弹窗样式 */\n.dialog-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 999;\n}\n\n.dialog-content {\n  width: 80%;\n  max-width: 600rpx;\n  background-color: #ffffff;\n  border-radius: 16rpx;\n  overflow: hidden;\n  box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.1);\n}\n\n.dialog-header {\n  padding: 30rpx;\n  text-align: center;\n  border-bottom: 1rpx solid #f0f0f0;\n}\n\n.dialog-title {\n  font-size: 32rpx;\n  font-weight: 500;\n  color: #333333;\n}\n\n.dialog-body {\n  padding: 30rpx;\n}\n\n.album-input {\n  width: 100%;\n  height: 80rpx;\n  background-color: #f5f5f5;\n  border-radius: 8rpx;\n  padding: 0 20rpx;\n  font-size: 28rpx;\n  box-sizing: border-box;\n}\n\n.dialog-footer {\n  display: flex;\n  border-top: 1rpx solid #f0f0f0;\n}\n\n.btn {\n  flex: 1;\n  height: 90rpx;\n  line-height: 90rpx;\n  text-align: center;\n  font-size: 30rpx;\n  border: none;\n  background-color: transparent;\n}\n\n.btn-cancel {\n  color: #666666;\n  border-right: 1rpx solid #f0f0f0;\n}\n\n.btn-confirm {\n  color: #28b389;\n  font-weight: 500;\n}\n</style>","import MiniProgramPage from 'C:/Users/ADMIN/Documents/HBuilderProjects/宝宝照片/pages/album/album.vue'\nwx.createPage(MiniProgramPage)"],"names":["useAlbumStore","ref","reactive","getAvatarUrl","onLoad","uni","MiniProgramPage"],"mappings":";;;;;;;;;;;;;;;;;;;AAMA,UAAM,aAAaA,aAAAA,cAAe;AAClC,UAAM,YAAYC,cAAG,IAAC,EAAE;AACxB,UAAM,UAAUC,cAAAA,SAAS;AAAA,MACvB;AAAA,QACE,MAAM;AAAA,QACN,OAAO;AAAA,UACL,iBAAiB;AAAA,QAClB;AAAA,MACF;AAAA,MACD;AAAA,QACE,MAAM;AAAA,QACN,OAAO;AAAA,UACL,iBAAiB;AAAA,QAClB;AAAA,MACF;AAAA,IACH,CAAC;AAGD,UAAM,mBAAmBD,cAAAA,IAAI,KAAK;AAClC,UAAM,YAAYA,cAAAA,IAAI,EAAE;AAExB,UAAM,mBAAmB,MAAM;AAC7B,uBAAiB,QAAQ;AACzB,gBAAU,QAAQ;AAAA,IACpB;AAEA,UAAM,oBAAoB,MAAM;AAC9B,uBAAiB,QAAQ;AAAA,IAC3B;AAGA,UAAM,iBAAiBA,cAAAA,IAAI,KAAK;AAChC,UAAM,gBAAgBA,cAAAA,IAAI,EAAE;AAC5B,UAAM,gBAAgBA,cAAAA,IAAI,IAAI;AAE9B,UAAM,WAAW,YAAY;AAC3B,gBAAU,QAAQ,MAAM,WAAW,aAAc;AACjD,eAAQ,IAAE,GAAG,IAAE,UAAU,MAAM,QAAQ,KAAK;AAC1C,YAAG,UAAU,MAAM,CAAC,EAAE,eAAc;AAClC,oBAAU,MAAM,CAAC,EAAE,gBAAgBE,uBAAa,UAAU,MAAM,CAAC,EAAE,aAAa;AAAA,QACtF,OAAW;AACL,oBAAU,MAAM,CAAC,EAAE,gBAAgB;AAAA,QACpC;AAAA,MACF;AAAA,IACH;AAEAC,kBAAAA,OAAO,YAAU;AACf,YAAM,SAAU;AAAA,IAClB,CAAC;AAED,UAAM,gBAAgB,YAAW;AAC/B,UAAI,UAAU,MAAM,QAAQ;AAC1B,cAAM,WAAW,eAAe,UAAU,KAAK;AAC/CC,sBAAA,MAAA,MAAA,OAAA,+BAAY,UAAU,UAAU,KAAK;AAGrC;AAEA,cAAM,SAAQ;AAAA,MAClB,OAAS;AAELA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACF;AAAA,IACH;AAEA,UAAM,cAAc,YAAW;AAC7B,UAAI,cAAc,MAAM,QAAQ;AAE9B,cAAM,WAAW,YAAY,cAAc,OAAO,cAAc,KAAK;AACrEA,sBAAAA,MAAA,MAAA,OAAA,+BAAY,cAAc,cAAc,OAAO,QAAQ,cAAc,KAAK;AAG1E;AAEA,cAAM,SAAQ;AAAA,MAClB,OAAS;AAELA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACF;AAAA,IACH;AAEA,UAAM,kBAAkB,MAAM;AAC5B,qBAAe,QAAQ;AACvB,oBAAc,QAAQ;AAAA,IACxB;AAEA,UAAM,cAAc,CAAC,UAAU;AAC7BA,oBAAY,MAAA,MAAA,OAAA,gCAAA,SAAS,KAAK;AAC1BA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,iCAAiC,MAAM,EAAE,SAAS,mBAAmB,MAAM,IAAI,CAAC;AAAA,MACzF,CAAG;AAAA,IACH;AAEA,UAAM,mBAAmB,CAAC,GAAG,MAAM,UAAU;AAE3C,UAAI,EAAE,UAAU,GAAG;AACjB,mBAAW,KAAK,IAAI,KAAK,IAAI;AAAA,MACjC,WAAa,EAAE,UAAU,GAAG;AACxB,qBAAa,IAAW;AAAA,MACzB;AAAA,IACH;AAEA,UAAM,aAAa,CAAC,IAAI,SAAS;AAC/BA,0BAAY,MAAA,OAAA,gCAAA,aAAa,KAAK,YAAY,IAAI;AAE9C,oBAAc,QAAQ;AACtB,oBAAc,QAAQ;AAEtB,qBAAe,QAAQ;AAAA,IACzB;AAGA,UAAM,eAAe,CAAC,SAAS;AAC7BA,oBAAY,MAAA,MAAA,OAAA,gCAAA,SAAS,IAAI;AAEzBA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,OAAO,QAAQ;AACtB,cAAI,IAAI,SAAS;AAEf,kBAAM,WAAW,YAAY,KAAK,EAAE;AAEpC,kBAAM,SAAQ;AAAA,UACf;AAAA,QACF;AAAA,MACL,CAAG;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1IA,GAAG,WAAWC,SAAe;"}