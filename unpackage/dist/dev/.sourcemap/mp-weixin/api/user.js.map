{"version":3,"file":"user.js","sources":["api/user.js"],"sourcesContent":["import {http} from '@/utils/http.js'\r\n\r\nexport const loginAPI = (code) => {\r\n    return http.postJSON('/user/login', {\r\n        code: code\r\n    })\r\n}\r\n\r\nexport const getUserInfoAPI = () => {\r\n    return http.get('/user/info');\r\n}\r\n\r\nexport const updateUserProfileAPI = async (profileData) => {\r\n    try {\r\n        const {nickname, partner_id, avatarFile} = profileData;\r\n        const formData = {};\r\n        if (nickname?.trim()) {\r\n            formData.nickname = nickname.trim();\r\n        }\r\n        if (partner_id && String(partner_id).trim()) {\r\n            formData.partner_id = String(partner_id).trim();\r\n        }\r\n        const API_ENDPOINT = '/user/profile/update';\r\n        if (avatarFile) {\r\n            const uploadConfig = {\r\n                header: {\r\n                    'Content-Type': 'multipart/form-data'\r\n                },\r\n                name: 'avatar'\r\n            };\r\n            return http.upload(API_ENDPOINT, avatarFile, formData, uploadConfig);\r\n        }else{\r\n            return http.postForm(API_ENDPOINT, formData);\r\n        }\r\n        throw new Error('没有有效的更新数据');\r\n    } catch (error) {\r\n        console.error('更新个人资料失败:', error);\r\n        uni.showToast({\r\n            title: error.message || '更新失败，请重试',\r\n            icon: 'none'\r\n        });\r\n        throw error;\r\n    }\r\n};\r\n"],"names":["http","uni"],"mappings":";;;AAEY,MAAC,WAAW,CAAC,SAAS;AAC9B,SAAOA,WAAI,KAAC,SAAS,eAAe;AAAA,IAChC;AAAA,EACR,CAAK;AACL;AAEY,MAAC,iBAAiB,MAAM;AAChC,SAAOA,WAAI,KAAC,IAAI,YAAY;AAChC;AAEY,MAAC,uBAAuB,OAAO,gBAAgB;AACvD,MAAI;AACA,UAAM,EAAC,UAAU,YAAY,WAAU,IAAI;AAC3C,UAAM,WAAW,CAAA;AACjB,QAAI,qCAAU,QAAQ;AAClB,eAAS,WAAW,SAAS;IAChC;AACD,QAAI,cAAc,OAAO,UAAU,EAAE,KAAI,GAAI;AACzC,eAAS,aAAa,OAAO,UAAU,EAAE,KAAI;AAAA,IAChD;AACD,UAAM,eAAe;AACrB,QAAI,YAAY;AACZ,YAAM,eAAe;AAAA,QACjB,QAAQ;AAAA,UACJ,gBAAgB;AAAA,QACnB;AAAA,QACD,MAAM;AAAA,MACtB;AACY,aAAOA,WAAAA,KAAK,OAAO,cAAc,YAAY,UAAU,YAAY;AAAA,IAC/E,OAAa;AACD,aAAOA,gBAAK,SAAS,cAAc,QAAQ;AAAA,IAC9C;AACD,UAAM,IAAI,MAAM,WAAW;AAAA,EAC9B,SAAQ,OAAO;AACZC,kBAAA,MAAA,MAAA,SAAA,qBAAc,aAAa,KAAK;AAChCA,kBAAAA,MAAI,UAAU;AAAA,MACV,OAAO,MAAM,WAAW;AAAA,MACxB,MAAM;AAAA,IAClB,CAAS;AACD,UAAM;AAAA,EACT;AACL;;;;"}